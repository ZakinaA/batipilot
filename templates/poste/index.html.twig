{% extends 'base.html.twig' %}

{% block title %}Postes{% endblock %}

{% block body %}
<div class="dashboard">

    <div class="top-bar">
        <h1>Postes</h1>
        <a href="{{ path('app_poste_new') }}" class="btn-add">+ Nouveau poste</a>
    </div>

    {% for poste in postes %}
        <details class="current">
            <summary class="poste-summary">
    <span class="poste-left">
        {{ poste.libelle }}
        <span class="count">{{ poste.etapes|length }}</span>
    </span>

    <span class="poste-right">
        <span class="montant ht">
            HT :
            {{ totauxParPoste[poste.id].ht ?? 0 | number_format(2, ',', ' ') }} €
        </span>
        <span class="montant ttc">
            TTC :
            {{ totauxParPoste[poste.id].ttc ?? 0 | number_format(2, ',', ' ') }} €
        </span>
    </span>
</summary>


            {% if poste.etapes|length > 0 %}
                {% for etape in poste.etapes %}
                    <a class="project-item"
                       href="{{ path('app_etape_show', {'id': etape.id}) }}">
                        <div>
                            <div class="client-name">
                                {{ etape.libelle }}
                            </div>
                        </div>
                    </a>
                {% endfor %}
            {% else %}
                <p style="padding:15px;">Aucune étape pour ce poste</p>
            {% endif %}
        </details>
    {% endfor %}

</div>
{% endblock %}
